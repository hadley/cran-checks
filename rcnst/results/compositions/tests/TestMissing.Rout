
R Under development (unstable) (2017-08-15 r73096) -- "Unsuffered Consequences"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library("compositions")
Loading required package: tensorA

Attaching package: 'tensorA'

The following object is masked from 'package:base':

    norm

Loading required package: robustbase
Loading required package: energy
Loading required package: bayesm
Welcome to compositions, a package for compositional data analysis.
Find an intro with "? compositions"


Attaching package: 'compositions'

The following objects are masked from 'package:stats':

    cor, cov, dist, var

The following objects are masked from 'package:base':

    %*%, scale, scale.default

> data(SimulatedAmounts)
> par(pch=20)
> mydata <- simulateMissings(sa.groups5,dl=0.01,knownlimit=TRUE,MAR=0.05,MNARprob=0.05,SZprob=0.05)
> 
> 
> cdata <- acomp(mydata)
Warning messages:
1: In acomp(mydata) :
  Negative values in composition are used as detection limits
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> cdata
      Cu          Zn         Pb           Cd            Co           
 [1,] 0.026679610         SZ 0.9279351504  1.082943e-02  3.455581e-02
 [2,]        MNAR 0.04028761 0.7162334485            SZ  2.434789e-01
 [3,]        MNAR 0.11140466 0.8885953360 <5.355543e-04 <5.355543e-04
 [4,]         MAR 0.08438520 0.9116584770  1.152135e-03  2.804192e-03
 [5,] 0.031225209 0.06477514 0.9037497666  9.499016e-05  1.548888e-04
 [6,] 0.093958313 0.13085571 0.7719289916  8.758945e-04  2.381090e-03
 [7,] 0.045414210 0.21676984 0.7350501198  9.575688e-04  1.808258e-03
 [8,] 0.015051926 0.13014259 0.8495954565  1.774087e-03  3.435944e-03
 [9,] 0.023546055 0.08624182 0.8889931603  5.065862e-04  7.123749e-04
[10,] 0.046592906 0.18381774 0.7495665367            SZ  2.002282e-02
[11,] 0.030384679 0.12097095 0.8484870671          MNAR  1.572995e-04
[12,] 0.004677034 0.01131463 0.9808424318  8.244257e-04  2.341481e-03
[13,] 0.007311120 0.01762118 0.9750676966 <9.384200e-05 <9.384200e-05
[14,] 0.015242934 0.06559599 0.9191610774          MNAR <3.662104e-04
[15,] 0.339489205 0.60589917           SZ  1.584821e-02  3.876341e-02
[16,] 0.433492340         SZ 0.4281338091  5.239161e-02  8.598224e-02
[17,] 0.075111032 0.11675010 0.6628272858  3.523097e-02  1.100806e-01
[18,] 0.042543074 0.07346226 0.8799345928          MNAR  4.060070e-03
[19,] 0.039029862 0.10750851 0.8465242410          MNAR  6.937386e-03
[20,] 0.249570081 0.60451940          MAR  5.818171e-02  8.772881e-02
[21,] 0.366076984 0.63323965           SZ  6.833663e-04 <2.143551e-04
[22,] 0.103871387 0.20270183 0.6911837477  1.447177e-03  7.958599e-04
[23,] 0.403340691 0.57379224 0.0221005903  7.664739e-04          MNAR
[24,] 0.638437230         SZ 0.3502997069  8.460510e-03  2.802553e-03
[25,] 0.260433746 0.66660331 0.0729629413           MAR           MAR
[26,] 0.237902025 0.58207546 0.1792379845            SZ  7.845288e-04
[27,] 0.214425053 0.73612003 0.0452947327  3.450772e-03  7.094092e-04
[28,] 0.072945698 0.28943930 0.6279127671  7.796307e-03  1.905932e-03
[29,] 0.193080981 0.32553302 0.4813860022 <2.664045e-04 <2.664045e-04
[30,] 0.143907566 0.51773247 0.1324223848  2.059376e-01           MAR
[31,]          SZ 0.96679716 0.0299948745  1.696247e-03  1.511723e-03
[32,]          SZ 0.65975341 0.2759764549  4.711820e-02  1.715194e-02
[33,] 0.017059650 0.10398122 0.8751200168  3.193523e-03  6.455902e-04
[34,] 0.052956173 0.94621692           SZ  8.269052e-04 <2.821789e-04
[35,] 0.179425377 0.59912344 0.2208002366  6.509440e-04 <3.942723e-04
[36,] 0.190916753 0.32415373 0.4745160091  1.041350e-02           MAR
[37,]         MAR 0.56056244 0.4341176151  3.221790e-03  2.098152e-03
[38,] 0.165514761 0.11752629 0.7169589481 <9.907019e-05 <9.907019e-05
[39,] 0.542924168         SZ 0.4553257133  1.098478e-03  6.516412e-04
[40,]         MAR 0.29786469 0.6447635265  3.625247e-02  2.111932e-02
[41,] 0.913444751         SZ 0.0681913286  1.836392e-02           MAR
[42,] 0.050301695 0.94778560 0.0019127051 <1.540438e-05          MNAR
[43,] 0.098303161 0.78001715 0.1179230373  3.035157e-03  7.214930e-04
[44,] 0.052304217 0.31099444 0.0132065679  5.487276e-01  7.476715e-02
[45,] 0.042824195 0.93975590 0.0018639968  1.369969e-02  1.856224e-03
[46,] 0.045998464 0.94673470 0.0071788028           MAR  8.802964e-05
[47,]         MAR 0.93436158 0.0164531459  4.217499e-02  7.010278e-03
[48,] 0.026657407 0.54377643 0.0085105768  3.548523e-01  6.620329e-02
[49,] 0.038874054 0.94001457 0.0079907027  1.157016e-02  1.550513e-03
[50,] 0.997794216         SZ 0.0017567491  4.490346e-04 <9.539347e-05
[51,] 0.080590178 0.81333320          MAR  8.974411e-02  1.633251e-02
[52,] 0.047088550 0.94999577 0.0008309680  1.914018e-03  1.706902e-04
[53,]         MAR 0.99327158 0.0063360701  3.923516e-04          MNAR
[54,] 0.157474955 0.82679647 0.0058939685  8.317945e-03  1.516662e-03
[55,] 0.122251079 0.76205250 0.0137935575           MAR  1.019029e-01
[56,] 0.115202196 0.87377137 0.0003904268  9.659659e-03  9.763446e-04
[57,] 0.081178921 0.91882108         MNAR          MNAR          MNAR
[58,] 0.033306898 0.95483424 0.0118588628          MNAR <8.889540e-05
[59,] 0.041170754 0.92502161 0.0057593870  2.431068e-02  3.737576e-03
[60,] 0.025298575 0.91413091 0.0007108718  5.197957e-02  7.880070e-03
attr(,"class")
[1] acomp
> mean(cdata)
        Cu         Zn         Pb         Cd         Co 
0.16391245 0.56790039 0.21936366 0.02763335 0.02119015 
attr(,"class")
[1] acomp
Warning messages:
1: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
3: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
4: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
5: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
6: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
7: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
8: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
9: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> mean(acomp(sa.groups5))
         Cu          Zn          Pb          Cd          Co 
0.141647429 0.659658588 0.190494272 0.005344234 0.002855477 
attr(,"class")
[1] acomp
Warning messages:
1: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
3: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
4: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
5: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
6: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
7: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
8: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
9: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
10: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> plot(acomp(sa.groups5))
There were 50 or more warnings (use warnings() to see the first 50)
> plot(mean(cdata),add=T,col="red")
There were 50 or more warnings (use warnings() to see the first 50)
> plot(mean(acomp(sa.groups5)),add=T,col="green")
There were 50 or more warnings (use warnings() to see the first 50)
> mean(cdata - mean(cdata))
       Cu        Zn        Pb        Cd        Co 
0.2381890 0.2770092 0.2401796 0.1283664 0.1162557 
attr(,"class")
[1] acomp
There were 20 warnings (use warnings() to see them)
> mm <-mean(cdata)
Warning messages:
1: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
3: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
4: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
5: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
6: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
7: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
8: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
9: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> erg <-var(cdata)
Warning messages:
1: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> print(erg)
           Cu         Zn         Pb         Cd         Co
Cu  0.9678822  0.8721216 -0.4461984 -0.5175373 -0.8762680
Zn  0.8721216  1.7614529 -2.5509296  0.5901588 -0.6728037
Pb -0.4461984 -2.5509296  8.2989743 -4.1224065 -1.1794398
Cd -0.5175373  0.5901588 -4.1224065  2.7607318  1.2890531
Co -0.8762680 -0.6728037 -1.1794398  1.2890531  1.4394584
> svd(erg)
$d
[1] 1.138543e+01 3.402009e+00 2.845609e-01 1.564949e-01 7.206186e-17

$u
            [,1]       [,2]       [,3]        [,4]      [,5]
[1,] -0.02319861  0.4944739  0.5801296 -0.46734038 0.4472136
[2,] -0.24499706  0.5398084 -0.3593303  0.56521245 0.4472136
[3,]  0.85075328 -0.1088420 -0.2504838 -0.04037508 0.4472136
[4,] -0.44288758 -0.3530932 -0.4705178 -0.50772906 0.4472136
[5,] -0.13967002 -0.5723470  0.5002022  0.45023207 0.4472136

$v
            [,1]       [,2]       [,3]        [,4]      [,5]
[1,] -0.02319861  0.4944739  0.5801296 -0.46734038 0.4472136
[2,] -0.24499706  0.5398084 -0.3593303  0.56521245 0.4472136
[3,]  0.85075328 -0.1088420 -0.2504838 -0.04037508 0.4472136
[4,] -0.44288758 -0.3530932 -0.4705178 -0.50772906 0.4472136
[5,] -0.13967002 -0.5723470  0.5002022  0.45023207 0.4472136

> ellipses(mm,erg)
There were 50 or more warnings (use warnings() to see the first 50)
> ellipses(mean(acomp(sa.groups5)),var(acomp(sa.groups5)))
There were 50 or more warnings (use warnings() to see the first 50)
> 
> cdata <- acomp(mydata)
Warning messages:
1: In acomp(mydata) :
  Negative values in composition are used as detection limits
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> plot(cdata)
There were 50 or more warnings (use warnings() to see the first 50)
> plot(mean(cdata),add=T,col="blue")
There were 50 or more warnings (use warnings() to see the first 50)
> plot(mean(acomp(sa.groups5)),add=T,col="green")
There were 50 or more warnings (use warnings() to see the first 50)
> mean(cdata - mean(cdata))
       Cu        Zn        Pb        Cd        Co 
0.2381890 0.2770092 0.2401796 0.1283664 0.1162557 
attr(,"class")
[1] acomp
There were 20 warnings (use warnings() to see them)
> mm <-mean(cdata)
Warning messages:
1: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
3: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
4: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
5: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
6: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
7: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
8: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
9: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> #erg <-var(cdata)
> svd(erg)
$d
[1] 1.138543e+01 3.402009e+00 2.845609e-01 1.564949e-01 7.206186e-17

$u
            [,1]       [,2]       [,3]        [,4]      [,5]
[1,] -0.02319861  0.4944739  0.5801296 -0.46734038 0.4472136
[2,] -0.24499706  0.5398084 -0.3593303  0.56521245 0.4472136
[3,]  0.85075328 -0.1088420 -0.2504838 -0.04037508 0.4472136
[4,] -0.44288758 -0.3530932 -0.4705178 -0.50772906 0.4472136
[5,] -0.13967002 -0.5723470  0.5002022  0.45023207 0.4472136

$v
            [,1]       [,2]       [,3]        [,4]      [,5]
[1,] -0.02319861  0.4944739  0.5801296 -0.46734038 0.4472136
[2,] -0.24499706  0.5398084 -0.3593303  0.56521245 0.4472136
[3,]  0.85075328 -0.1088420 -0.2504838 -0.04037508 0.4472136
[4,] -0.44288758 -0.3530932 -0.4705178 -0.50772906 0.4472136
[5,] -0.13967002 -0.5723470  0.5002022  0.45023207 0.4472136

> ellipses(mm,erg)
There were 50 or more warnings (use warnings() to see the first 50)
> ellipses(mm,erg,r=2)
There were 50 or more warnings (use warnings() to see the first 50)
> 
> 
> 
> #cdata <- rcomp(mydata)
> #cdata
> 
> #mean(cdata)
> #mean(rcomp(sa.groups5))
> #plot(rcomp(sa.groups5))
> #plot(mean(cdata),add=T,col="red",pch=20)
> #plot(mean(rcomp(sa.groups5)),add=T,col="green",pch=20)
> #mean(cdata - mean(cdata)) # Nonsense because the difference is noncompositional
> 
> 
> cdata <- aplus(mydata)
> cdata
      Cu          Zn           Pb          Cd           Co         
 [1,]   2.3256100           SZ  80.8863102   0.94398005  3.01216337
 [2,]        MNAR    0.7845092  13.9470095           SZ  4.74119583
 [3,]        MNAR    2.0801748  16.5920669 <0.01000000  <0.01000000
 [4,]         MAR    7.0077322  75.7082851   0.09567857  0.23287289
 [5,]   5.7495157   11.9270845 166.4079616   0.01749059  0.02851976
 [6,]   3.0998406    4.3171470  25.4672180   0.02889721  0.07855612
 [7,]   2.9568436   14.1135236  47.8578897   0.06234571  0.11773265
 [8,]   3.0623422   26.4777503 172.8517697   0.36094134  0.69904915
 [9,]   3.0832479   11.2929712 116.4095761   0.06633514  0.09328223
[10,]   2.0766690    8.1928484  33.4085541           SZ  0.89242687
[11,]   8.0027990   31.8616572 223.4768193         MNAR  0.04142996
[12,]   0.7914460    1.9146573 165.9778114   0.13950902  0.39622464
[13,]   0.7790883    1.8777502 103.9052563 <0.01000000  <0.01000000
[14,]   0.4162343    1.7912103  25.0992607         MNAR <0.01000000
[15,]   3.2010766    5.7130820          SZ   0.14943429  0.36550397
[16,]   8.1217339           SZ   8.0213387   0.98158755  1.61092791
[17,]   3.3477372    5.2036119  29.5425518   1.57026242  4.90634916
[18,]   3.9018132    6.7375485  80.7026878         MNAR  0.37236699
[19,]   2.8994556    7.9866066  62.8867060         MNAR  0.51536549
[20,]   6.5626807   15.8964079         MAR   1.52994294  2.30691173
[21,]  17.0780648   29.5416217          SZ   0.03188011 <0.01000000
[22,]   2.2128852    4.3183778  14.7250399   0.03083080  0.01695507
[23,]  20.5441099   29.2260393   1.1256909   0.03904026        MNAR
[24,]  17.4091154           SZ   9.5520871   0.23070396  0.07642094
[25,]  16.1057611   41.2241264   4.5121791          MAR         MAR
[26,]  22.7793861   55.7343791  17.1622383           SZ  0.07511951
[27,]  23.5806451   80.9522254   4.9811298   0.37948663  0.07801480
[28,]   1.8324417    7.2708966  15.7735623   0.19584811  0.04787820
[29,]   7.2476612   12.2194998  18.0697375 <0.01000000  <0.01000000
[30,]   7.6306949   27.4527504   7.0216935  10.91983495         MAR
[31,]          SZ  206.2999218   6.4004535   0.36195352  0.32257893
[32,]          SZ   22.4674773   9.3982004   1.60457988  0.58409817
[33,]   0.8110964    4.9437589  41.6073436   0.15183519  0.03069441
[34,]   1.8766879   33.5325182          SZ   0.02930429 <0.01000000
[35,]   4.5507981   15.1956755   5.6001961   0.01651001 <0.01000000
[36,]   4.9706321    8.4395369  12.3543088   0.27112180         MAR
[37,]         MAR    9.6117618   7.4436580   0.05524286  0.03597626
[38,]  16.7068169   11.8629313  72.3687834 <0.01000000  <0.01000000
[39,]  14.4839905           SZ  12.1470616   0.02930491  0.01738431
[40,]         MAR    7.0294182  15.2160115   0.85553525  0.49840265
[41,]  10.9530081           SZ   0.8176742   0.22019960         MAR
[42,]  32.6541421  615.2700400   1.2416628 <0.01000000         MNAR
[43,]   3.8967707   30.9201450   4.6745093   0.12031465  0.02860023
[44,]  19.8153945  117.8198968   5.0032936 207.88485371 28.32545225
[45,]  13.8730239  304.4366853   0.6038472   4.43805373  0.60132928
[46,]  11.7536378  241.9119212   1.8343449          MAR  0.02249354
[47,]         MAR   80.2172745   1.4125437   3.62082849  0.60184985
[48,]   5.0354151  102.7159212   1.6075940  67.02934817 12.50538258
[49,]   5.7917797  140.0511873   1.1905213   1.72381849  0.23100839
[50,] 104.5977477           SZ   0.1841582   0.04707184 <0.01000000
[51,]   6.4215460   64.8076064         MAR   7.15094526  1.30139867
[52,]  60.7770808 1226.1573067   1.0725284   2.47041878  0.22030942
[53,]         MAR  585.3091893   3.7336819   0.23120261        MNAR
[54,]  16.8602396   88.5219277   0.6310446   0.89057043  0.16238316
[55,]   6.2720284   39.0967097   0.7076713          MAR  5.22807356
[56,]  58.9170062  446.8664238   0.1996731   4.94016780  0.49932471
[57,]  33.9838386  384.6450147        MNAR         MNAR        MNAR
[58,]   3.7467515  107.4109817   1.3340243         MNAR <0.01000000
[59,]   7.1692915  161.0791359   1.0029140   4.23335288  0.65084480
[60,]  26.3978996  953.8535679   0.7417621  54.23829107  8.22249084
attr(,"class")
[1] aplus
> mean(cdata)
[1]  6.7834399 27.9343261  8.5557857  0.4451112  0.3329464
attr(,"class")
[1] aplus
Warning messages:
1: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
3: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
4: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
5: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> mean(aplus(sa.groups5))
        Cu         Zn         Pb         Cd         Co 
 6.1194322 28.4984768  8.2297065  0.2308808  0.1233619 
attr(,"class")
[1] aplus
> plot(aplus(sa.groups5))
> plot(mean(cdata),add=T,col="red",pch=20)
Warning messages:
1: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
3: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
4: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
5: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> plot(mean(aplus(sa.groups5)),add=T,col="green",pch=20)
> mean(cdata - mean(cdata))
[1]    1    1    1    1    1
attr(,"class")
[1] aplus
Warning messages:
1: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
3: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
4: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
5: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
6: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
7: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
8: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
9: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
10: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> 
> cdata <- rplus(mydata)
> cdata
      Cu          Zn           Pb          Cd           Co         
 [1,]   2.3256100           SZ  80.8863102   0.94398005  3.01216337
 [2,]        MNAR    0.7845092  13.9470095           SZ  4.74119583
 [3,]        MNAR    2.0801748  16.5920669 <0.01000000  <0.01000000
 [4,]         MAR    7.0077322  75.7082851   0.09567857  0.23287289
 [5,]   5.7495157   11.9270845 166.4079616   0.01749059  0.02851976
 [6,]   3.0998406    4.3171470  25.4672180   0.02889721  0.07855612
 [7,]   2.9568436   14.1135236  47.8578897   0.06234571  0.11773265
 [8,]   3.0623422   26.4777503 172.8517697   0.36094134  0.69904915
 [9,]   3.0832479   11.2929712 116.4095761   0.06633514  0.09328223
[10,]   2.0766690    8.1928484  33.4085541           SZ  0.89242687
[11,]   8.0027990   31.8616572 223.4768193         MNAR  0.04142996
[12,]   0.7914460    1.9146573 165.9778114   0.13950902  0.39622464
[13,]   0.7790883    1.8777502 103.9052563 <0.01000000  <0.01000000
[14,]   0.4162343    1.7912103  25.0992607         MNAR <0.01000000
[15,]   3.2010766    5.7130820          SZ   0.14943429  0.36550397
[16,]   8.1217339           SZ   8.0213387   0.98158755  1.61092791
[17,]   3.3477372    5.2036119  29.5425518   1.57026242  4.90634916
[18,]   3.9018132    6.7375485  80.7026878         MNAR  0.37236699
[19,]   2.8994556    7.9866066  62.8867060         MNAR  0.51536549
[20,]   6.5626807   15.8964079         MAR   1.52994294  2.30691173
[21,]  17.0780648   29.5416217          SZ   0.03188011 <0.01000000
[22,]   2.2128852    4.3183778  14.7250399   0.03083080  0.01695507
[23,]  20.5441099   29.2260393   1.1256909   0.03904026        MNAR
[24,]  17.4091154           SZ   9.5520871   0.23070396  0.07642094
[25,]  16.1057611   41.2241264   4.5121791          MAR         MAR
[26,]  22.7793861   55.7343791  17.1622383           SZ  0.07511951
[27,]  23.5806451   80.9522254   4.9811298   0.37948663  0.07801480
[28,]   1.8324417    7.2708966  15.7735623   0.19584811  0.04787820
[29,]   7.2476612   12.2194998  18.0697375 <0.01000000  <0.01000000
[30,]   7.6306949   27.4527504   7.0216935  10.91983495         MAR
[31,]          SZ  206.2999218   6.4004535   0.36195352  0.32257893
[32,]          SZ   22.4674773   9.3982004   1.60457988  0.58409817
[33,]   0.8110964    4.9437589  41.6073436   0.15183519  0.03069441
[34,]   1.8766879   33.5325182          SZ   0.02930429 <0.01000000
[35,]   4.5507981   15.1956755   5.6001961   0.01651001 <0.01000000
[36,]   4.9706321    8.4395369  12.3543088   0.27112180         MAR
[37,]         MAR    9.6117618   7.4436580   0.05524286  0.03597626
[38,]  16.7068169   11.8629313  72.3687834 <0.01000000  <0.01000000
[39,]  14.4839905           SZ  12.1470616   0.02930491  0.01738431
[40,]         MAR    7.0294182  15.2160115   0.85553525  0.49840265
[41,]  10.9530081           SZ   0.8176742   0.22019960         MAR
[42,]  32.6541421  615.2700400   1.2416628 <0.01000000         MNAR
[43,]   3.8967707   30.9201450   4.6745093   0.12031465  0.02860023
[44,]  19.8153945  117.8198968   5.0032936 207.88485371 28.32545225
[45,]  13.8730239  304.4366853   0.6038472   4.43805373  0.60132928
[46,]  11.7536378  241.9119212   1.8343449          MAR  0.02249354
[47,]         MAR   80.2172745   1.4125437   3.62082849  0.60184985
[48,]   5.0354151  102.7159212   1.6075940  67.02934817 12.50538258
[49,]   5.7917797  140.0511873   1.1905213   1.72381849  0.23100839
[50,] 104.5977477           SZ   0.1841582   0.04707184 <0.01000000
[51,]   6.4215460   64.8076064         MAR   7.15094526  1.30139867
[52,]  60.7770808 1226.1573067   1.0725284   2.47041878  0.22030942
[53,]         MAR  585.3091893   3.7336819   0.23120261        MNAR
[54,]  16.8602396   88.5219277   0.6310446   0.89057043  0.16238316
[55,]   6.2720284   39.0967097   0.7076713          MAR  5.22807356
[56,]  58.9170062  446.8664238   0.1996731   4.94016780  0.49932471
[57,]  33.9838386  384.6450147        MNAR         MNAR        MNAR
[58,]   3.7467515  107.4109817   1.3340243         MNAR <0.01000000
[59,]   7.1692915  161.0791359   1.0029140   4.23335288  0.65084480
[60,]  26.3978996  953.8535679   0.7417621  54.23829107  8.22249084
attr(,"class")
[1] rplus
> mean(cdata)
[1]  12.624821 107.726502  30.747402   7.458605   1.553757
attr(,"class")
[1] rplus
Warning messages:
1: In sumMissingProjector.rplus(orig) :
  sumMissingProjector.rplus: There is no established theory available for missings in nonrelative positive geometry. Results are experimental. 
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
3: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
4: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
5: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
6: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> mean(rplus(sa.groups5))
        Cu         Zn         Pb         Cd         Co 
 13.183423 121.515630  31.862701   6.996818   1.399201 
attr(,"class")
[1] rplus
> plot(rplus(sa.groups5))
> plot(mean(cdata),add=T,col="red",pch=20)
Warning messages:
1: In sumMissingProjector.rplus(orig) :
  sumMissingProjector.rplus: There is no established theory available for missings in nonrelative positive geometry. Results are experimental. 
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
3: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
4: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
5: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
6: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> plot(mean(rplus(sa.groups5)),add=T,col="green",pch=20)
> mean(cdata - mean(cdata)) # Nonsense because the difference is non compositonal
[1]  0.495091027 12.673706126  1.808670688  0.437761078 -0.001960784
attr(,"class")
[1] "rmult"
There were 11 warnings (use warnings() to see them)
> 
> 
> plot(acomp(mydata))
There were 50 or more warnings (use warnings() to see the first 50)
> plot(aplus(mydata))
> plot(rcomp(mydata))
There were 50 or more warnings (use warnings() to see the first 50)
> plot(rplus(mydata))
> 
> boxplot(acomp(mydata))
There were 26 warnings (use warnings() to see them)
> boxplot(aplus(mydata))
> boxplot(rcomp(mydata))
Warning messages:
1: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
2: In acomp(x) :
  Negative values in composition are used as detection limits
3: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> boxplot(rplus(mydata))
> 
> barplot(acomp(mydata))
Warning messages:
1: In acomp(mydata) :
  Negative values in composition are used as detection limits
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
3: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> barplot(aplus(mydata))
> barplot(rcomp(mydata))
Warning messages:
1: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
2: In structure(c(), class = c(class(x), class(y))) :
  Calling 'structure(NULL, *)' is deprecated, as NULL cannot have attributes.
  Consider 'structure(list(), *)' instead.
> barplot(rplus(mydata))
> 
> proc.time()
   user  system elapsed 
 23.632   0.352  24.153 
