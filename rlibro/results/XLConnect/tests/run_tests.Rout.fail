
R Under development (unstable) (2018-01-02 r74022) -- "Unsuffered Consequences"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #############################################################################
> #
> # XLConnect
> # Copyright (C) 2010-2013 Mirai Solutions GmbH
> #
> # This program is free software: you can redistribute it and/or modify
> # it under the terms of the GNU General Public License as published by
> # the Free Software Foundation, either version 3 of the License, or
> # (at your option) any later version.
> #
> # This program is distributed in the hope that it will be useful,
> # but WITHOUT ANY WARRANTY; without even the implied warranty of
> # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
> # GNU General Public License for more details.
> #
> # You should have received a copy of the GNU General Public License
> # along with this program.  If not, see <http://www.gnu.org/licenses/>.
> #
> #############################################################################
> 
> #############################################################################
> #
> # RUnit test-runner script
> # 
> # Author: Martin Studer, Mirai Solutions GmbH
> #
> #############################################################################
> 
> # Set timezone to UTC
> Sys.setenv("TZ" = "UTC")
> 
> # Limit number of GC threads; set timezone
> options(java.parameters = c("-XX:+UseParallelGC", "-XX:ParallelGCThreads=1", paste0("-Duser.timezone=", Sys.timezone())))
> 
> # Load library built by R CMD check
> library(package = "XLConnect", character.only = TRUE)
Loading required package: XLConnectJars
XLConnect 0.2-13 by Mirai Solutions GmbH [aut],
  Martin Studer [cre],
  The Apache Software Foundation [ctb, cph] (Apache POI),
  Graph Builder [ctb, cph] (Curvesapi Java library)
http://www.mirai-solutions.com ,
http://miraisolutions.wordpress.com
> require(rJava)
Loading required package: rJava
> 
> rsrc <- function(resource) {
+   file.path(options()$path.unit.tests, resource)
+ }
> 
> checkNoException <- function(expr) {
+         res <- try(expr)
+         checkTrue(!is(res, "try-error"))
+ }
> 
> runUnitTests <- function() {
+ 	
+ 	pkg <- "XLConnect"
+ 	
+ 	# Option to determine if full test suite should be run
+ 	options("FULL.TEST.SUITE" = Sys.getenv("FULL_TEST_SUITE") == "1")
+ 
+ 	# RUnit is required for unit testing
+ 	if(require("RUnit", quietly = TRUE)) {
+ 		if(Sys.getenv("RCMDCHECK") == "FALSE") {
+ 			# Path to unit tests for standalone running under Makefile (not R CMD check)
+ 			path <- file.path(getwd(), "..", "inst", "unitTests")
+ 		} else {
+ 			# Path to unit tests for 'R CMD check' and as part of public API
+ 			path <- system.file(package = pkg, "unitTests")
+ 		}
+ 		cat("\nRunning Unit Tests\n")
+ 		print(list(WorkingDir = getwd(), PathToUnitTests = path))
+ 		
+ 		# Add path to unit tests as option
+ 		# (used by rsrc function in unit tests)
+ 		options(path.unit.tests = path)
+ 		
+ 		# Set up and run test suite
+ 		Sys.setlocale(category = "LC_NUMERIC", locale = "C")
+ 		jlocale = J("java.util.Locale")
+ 		jlocale$setDefault(jlocale$US)
+ 		orig.opts <- options(encoding = "UTF-8")
+ 		TestSuite <- defineTestSuite(paste(pkg, "Test Suite"), dirs = path)
+ 		TestResult <- runTestSuite(TestSuite)
+ 		options(orig.opts)
+ 		
+ 		# Test protocol files
+ 		protocol <- file.path(getwd(), paste(pkg, "Unit_Tests", sep = "_"))
+ 		txtProtocol <- paste(protocol, ".txt", sep = "")
+ 		htmlProtocol <- paste(protocol, ".html", sep = "")
+ 		
+ 		# Print (summary) test protocol to stdout
+ 		printTextProtocol(TestResult, showDetails = FALSE)
+ 		# Write detailed test protocol to text file
+ 		printTextProtocol(TestResult, showDetails = TRUE, fileName = txtProtocol)
+ 		# Write HTML protocol
+ 		printHTMLProtocol(TestResult, fileName = htmlProtocol)
+ 		
+ 		# Show HTML Test Protocol
+ 		browseURL(url = htmlProtocol)
+ 		
+ 		## Return stop() to cause R CMD check stop in case of
+ 		##  - failures i.e. FALSE to unit tests or
+ 		##  - errors i.e. R errors
+ 		tmp <- getErrors(TestResult)
+ 		if(tmp$nFail > 0 | tmp$nErr > 0) {
+ 			stop(paste("\n\nUnit Testing failed (#test failures: ", tmp$nFail,
+ 				", #R errors: ",  tmp$nErr, ")\n\n", sep=""))
+ 		}
+ 	} else {
+ 		warning("Cannot run unit tests -- Package 'RUnit' is not available!")
+ 	}
+ 	
+ 	invisible()
+ }
> 
> # Run unit tests
> runUnitTests()

Running Unit Tests
$WorkingDir
[1] "/home/tomas/cran/rlibro/check/XLConnect.Rcheck/tests"

$PathToUnitTests
[1] "/homero/tomas/cran/rlibro/lib/XLConnect/unitTests"



Executing test function test.arefidx  ...  done successfully.



Executing test function test.cellStyle  ... Error : IllegalArgumentException (Java): Cell style Header does not exist
Error : IllegalArgumentException (Java): Cell style Header does not exist
 done successfully.



Executing test function test.colidx  ...  done successfully.



Executing test function test.crefidx  ...  done successfully.



Executing test function test.dataframeConversion  ... Error in as.data.frame.default(df) : 
  cannot coerce class '"function"' to a data.frame
Error in try(eval(expr, envir = parent.frame()), silent = silent) : 
  Invalid object - object of class 'jobjRef' required!
Error in try(eval(expr, envir = parent.frame()), silent = silent) : 
  Invalid object - object of class 'jobjRef' required!
Error in try(eval(expr, envir = parent.frame()), silent = silent) : 
  Invalid object - object of class 'jobjRef' required!
Error in try(eval(expr, envir = parent.frame()), silent = silent) : 
  Invalid object - object of class 'jobjRef' required!
 done successfully.



Executing test function test.dumpAndRestore  ...  done successfully.



Executing test function test.extractSheetName  ...  done successfully.



Executing test function test.loadWorkbook  ... Error : FileNotFoundException (Java): File 'fileWhichDoesNotExist.xls' could not be found - you may specify to automatically create the file if not existing.
Error : FileNotFoundException (Java): File 'fileWhichDoesNotExist.xlsx' could not be found - you may specify to automatically create the file if not existing.
Error : EncryptedDocumentException (Java): The supplied spreadsheet is protected, but no password was supplied
Error : EncryptedDocumentException (Java): Password incorrect
 done successfully.



Executing test function test.with.workbook  ...  done successfully.



Executing test function test.workbook.createName  ... Error : IllegalArgumentException (Java): java.lang.IllegalArgumentException: Invalid name: ''Test': first character must be underscore or a letter
Error : IllegalArgumentException (Java): java.lang.IllegalArgumentException: Invalid name: ''Test': first character must be underscore or a letter
Error : IllegalArgumentException (Java): org.apache.poi.ss.formula.FormulaParseException: Parse error near char 0 '?' in specified formula '??-%&'. Expected cell ref or constant literal
Error : IllegalArgumentException (Java): org.apache.poi.ss.formula.FormulaParseException: Parse error near char 0 '?' in specified formula '??-%&'. Expected cell ref or constant literal
Error : IllegalArgumentException (Java): Specified name 'ImHere' already exists!
Error : IllegalArgumentException (Java): Specified name 'ImHere' already exists!
Error : IllegalArgumentException (Java): org.apache.poi.ss.formula.FormulaParseException: Specified name 'A1A4' for sheet Test not found
 done successfully.



Executing test function test.workbook.createSheet  ... Error : IllegalArgumentException (Java): Invalid sheet name ''Invalid Sheet Name'. Sheet names must not begin or end with (').
Error : IllegalArgumentException (Java): Invalid sheet name ''Invalid Sheet Name'. Sheet names must not begin or end with (').
Error : IllegalArgumentException (Java): Invalid sheet name 'Invalid Sheet Name''. Sheet names must not begin or end with (').
Error : IllegalArgumentException (Java): Invalid sheet name 'Invalid Sheet Name''. Sheet names must not begin or end with (').
Error : IllegalArgumentException (Java): Sheet names are not allowed to contain more than 31 characters!
Error : IllegalArgumentException (Java): Sheet names are not allowed to contain more than 31 characters!
 done successfully.



Executing test function test.workbook.existsName  ...  done successfully.



Executing test function test.workbook.existsSheet  ...  done successfully.



Executing test function test.workbook.extraction  ...  done successfully.



Executing test function test.workbook.getBoundingBox  ...  done successfully.



Executing test function test.workbook.getDefinedNames  ...  done successfully.



Executing test function test.workbook.getSheetPos  ...  done successfully.



Executing test function test.workbook.getSheets  ...  done successfully.



Executing test function test.workbook.hideSheet  ...  done successfully.



Executing test function test.workbook.onErrorCell  ... Error : IllegalArgumentException (Java): Error when trying to evaluate cell C10 - Error detected in cell C10 - No such name defined
In addition: Warning messages:
1: Error detected in cell C10 - No such name defined 
2: Error detected in cell D8 - Incompatible type 
3: Error detected in cell E8 - Incompatible type 
4: Error detected in cell F11 - Division by 0 
5: Error when trying to evaluate cell G9 - Could not resolve external workbook name '/home/mstuder/Documents/Projects/R/XLConnect/xlconnect/inst/unitTests/resources/MySheet2'. Workbook environment has not been set up. 
6: Error when trying to evaluate cell C10 - Specified named range 'myname' does not exist in the current workbook. 
7: Error detected in cell D8 - Incompatible type 
8: Error detected in cell E8 - Incompatible type 
9: Error detected in cell F11 - Division by 0 
10: Error when trying to evaluate cell G9 - Index: 0, Size: 0 
Error : IllegalArgumentException (Java): Error when trying to evaluate cell D8 - Error detected in cell D8 - Incompatible type
Error : IllegalArgumentException (Java): Error when trying to evaluate cell E8 - Error detected in cell E8 - Incompatible type
Error : IllegalArgumentException (Java): Error when trying to evaluate cell F11 - Error detected in cell F11 - Division by 0
Error : IllegalArgumentException (Java): Error when trying to evaluate cell G9 - Could not resolve external workbook name '/home/mstuder/Documents/Projects/R/XLConnect/xlconnect/inst/unitTests/resources/MySheet2'. Workbook environment has not been set up.
Error : IllegalArgumentException (Java): Error when trying to evaluate cell C10 - Specified named range 'myname' does not exist in the current workbook.
Error : IllegalArgumentException (Java): Error when trying to evaluate cell D8 - Error detected in cell D8 - Incompatible type
Error : IllegalArgumentException (Java): Error when trying to evaluate cell E8 - Error detected in cell E8 - Incompatible type
Error : IllegalArgumentException (Java): Error when trying to evaluate cell F11 - Error detected in cell F11 - Division by 0
Error : IllegalArgumentException (Java): Error when trying to evaluate cell G9 - Index: 0, Size: 0
 done successfully.



Executing test function test.workbook.readNamedRegion  ... Error : IllegalArgumentException (Java): Name 'NameThatDoesNotExist' does not exist!
Error : IllegalArgumentException (Java): Name 'NameThatDoesNotExist' does not exist!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Specify either keep OR drop (not both)
In addition: Warning messages:
1: Cell B8 cannot be converted from String to Numeric - returning NA 
2: Cell E10 cannot be converted from String to DateTime - returning NA 
3: Cell B8 cannot be converted from String to Numeric - returning NA 
4: Cell E10 cannot be converted from String to DateTime - returning NA 
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Specify either keep OR drop (not both)
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column name(s) 'ZZZ' not existing or out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column name(s) 'ZZZ' not existing or out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column(s) '5' out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column(s) '5' out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column name(s) 'ZZZ' not existing or out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column name(s) 'ZZZ' not existing or out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column(s) '5' out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column(s) '5' out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Header=F and keep values NumericColumn, BooleanColumn of type character
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Header=F and keep values NumericColumn, BooleanColumn of type character
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Header=F and drop values StringColumn, DateTimeColumn of type character
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Header=F and drop values StringColumn, DateTimeColumn of type character
Error : IllegalArgumentException (Java): Name 'HeaderRemote' does not exist!
Error : IllegalArgumentException (Java): Error when trying to evaluate cell A2 - Could not resolve external workbook name '/Documents and Settings/pa022139/My Documents/reboots.xls'. Workbook environment has not been set up.
Error : IllegalArgumentException (Java): Name 'AllRemote' does not exist!
Error : IllegalArgumentException (Java): Name 'HeaderRemote' does not exist!
Error : IllegalArgumentException (Java): Error when trying to evaluate cell A2 - Could not resolve external workbook name '/Documents%20and%20Settings/pa022139/My%20Documents/reboots.xls'. Workbook environment has not been set up.
Error : IllegalArgumentException (Java): Name 'AllRemote' does not exist!
 done successfully.



Executing test function test.workbook.readWorksheet  ... Error : IllegalArgumentException (Java): Sheet index (22) is out of range (0..9)
Error : IllegalArgumentException (Java): Sheet index (-1) is out of range (0..9)
Error : IllegalArgumentException (Java): Sheet index (22) is out of range (0..9)
Error : IllegalArgumentException (Java): Sheet index (-1) is out of range (0..9)
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Specify either keep OR drop (not both)
In addition: Warning messages:
1: Data frame contains 0 rows and 0 columns! 
2: Data frame contains 0 rows and 0 columns! 
3: Data frame contains 0 rows and 0 columns! 
4: Data frame contains 0 rows and 0 columns! 
5: Cell A3 cannot be converted from String to Numeric - returning NA 
6: Cell D5 cannot be converted from String to DateTime - returning NA 
7: Cell A3 cannot be converted from String to Numeric - returning NA 
8: Cell D5 cannot be converted from String to DateTime - returning NA 
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Specify either keep OR drop (not both)
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column name(s) 'Z' not existing or out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column name(s) 'Z' not existing or out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column(s) '5' out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column(s) '5' out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column name(s) 'Z' not existing or out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column name(s) 'Z' not existing or out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column(s) '5' out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column(s) '5' out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Header=F and keep values A, C of type character
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Header=F and keep values A, C of type character
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Header=F and drop values B, D of type character
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Header=F and drop values B, D of type character
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Specify either keep OR drop (not both)
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Specify either keep OR drop (not both)
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column name(s) 'Z' not existing or out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column name(s) 'Z' not existing or out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column(s) '5' out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column(s) '5' out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column name(s) 'Z' not existing or out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column name(s) 'Z' not existing or out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column(s) '5' out of the bounding box!
Error in getColSubset(object, sheet, startRow, endRow, startCol, endCol,  : 
  Column(s) '5' out of the bounding box!
Error : IllegalArgumentException (Java): Sheet index (-1) is out of range (0..3)
Error : IllegalArgumentException (Java): Error when trying to evaluate cell A2 - Could not resolve external workbook name '/Documents and Settings/pa022139/My Documents/reboots.xls'. Workbook environment has not been set up.
Error : IllegalArgumentException (Java): Sheet index (-1) is out of range (0..3)
Error : IllegalArgumentException (Java): Sheet index (-1) is out of range (0..3)
Error : IllegalArgumentException (Java): Error when trying to evaluate cell A2 - Could not resolve external workbook name '/Documents%20and%20Settings/pa022139/My%20Documents/reboots.xls'. Workbook environment has not been set up.
Error : IllegalArgumentException (Java): Sheet index (-1) is out of range (0..3)
 done successfully.



Executing test function test.workbook.renameSheet  ... Error : IllegalArgumentException (Java): Sheet index (-1) is out of range (0..1)
Error : IllegalArgumentException (Java): Sheet index (-1) is out of range (0..1)
Error : IllegalArgumentException (Java): Invalid sheet name ''invalid'. Sheet names must not begin or end with (').
Error : IllegalArgumentException (Java): Invalid sheet name ''invalid'. Sheet names must not begin or end with (').
 done successfully.



Executing test function test.workbook.saveWorkbook  ... Timing stopped at: 0.02 0.004 0.024
Error : FileNotFoundException (Java): /homero/tomas/cran/rlibro/lib/XLConnect/unitTests/resources/testWorkbookSaveWorkbook.xls (Read-only file system)
In addition: Warning messages:
1: In file.remove(file.xls) :
  cannot remove file '/homero/tomas/cran/rlibro/lib/XLConnect/unitTests/resources/testWorkbookSaveWorkbook.xls', reason 'Read-only file system'
2: In file.remove(file.xlsx) :
  cannot remove file '/homero/tomas/cran/rlibro/lib/XLConnect/unitTests/resources/testWorkbookSaveWorkbook.xlsx', reason 'Read-only file system'
 done successfully.



Executing test function test.workbook.setMissingValue  ...  done successfully.



Executing test function test.workbook.setSheetPos  ... Error : IndexOutOfBoundsException (Java): Index: -2, Size: 3
Error : IndexOutOfBoundsException (Java): Index: 36297, Size: 2
Error : IndexOutOfBoundsException (Java): Index: -2, Size: 3
Error : ArrayIndexOutOfBoundsException (Java): -1
Error : ArrayIndexOutOfBoundsException (Java): -1
Error : ArrayIndexOutOfBoundsException (Java): -1
 done successfully.



Executing test function test.workbook.writeNamedRegion  ... Error in as.data.frame.default(x) : 
  cannot coerce class '"function"' to a data.frame
Error in as.data.frame.default(x) : 
  cannot coerce class '"function"' to a data.frame
Error : IllegalArgumentException (Java): Name 'nameDoesNotExist' does not exist!
Error : IllegalArgumentException (Java): Name 'nameDoesNotExist' does not exist!
Error : IllegalArgumentException (Java): Name 'nope' has invalid reference!
Error : IllegalArgumentException (Java): Name 'nope' does not refer to a valid sheet!
 done successfully.



Executing test function test.workbook.writeWorksheet  ... Error in as.data.frame.default(x) : 
  cannot coerce class '"function"' to a data.frame
Error in as.data.frame.default(x) : 
  cannot coerce class '"function"' to a data.frame
Error : IllegalArgumentException (Java): Sheet index (-1) is out of range (0..0)
Error : IllegalArgumentException (Java): Sheet index (-1) is out of range (0..0)
 done successfully.



Executing test function test.writeAndReadNamedRegion  ...  done successfully.



Executing test function test.workbook.writeAndReadWorksheet  ...  done successfully.



Executing test function test.writeNamedRegionToFile  ... [1] "Writing dataset  cdf to file testWriteNamedRegionToFileWorkbook.xls"
[1] "Writing dataset  cdf to file testWriteNamedRegionToFileWorkbook.xlsx"
 done successfully.



Executing test function test.writeWorksheetToFile  ... [1] "Writing dataset  cdf to file testWriteWorksheetToFileWorkbook.xls"
[1] "Writing dataset  cdf to file testWriteWorksheetToFileWorkbook.xlsx"
 done successfully.

RUNIT TEST PROTOCOL -- Tue Jan  2 17:42:55 2018 
*********************************************** 
Number of test functions: 32 
Number of errors: 1 
Number of failures: 0 

 
1 Test Suite : 
XLConnect Test Suite - 32 test functions, 1 error, 0 failures
ERROR in test.workbook.saveWorkbook: Error : FileNotFoundException (Java): /homero/tomas/cran/rlibro/lib/XLConnect/unitTests/resources/testWorkbookSaveWorkbook.xls (Read-only file system)
Error in runUnitTests() : 

Unit Testing failed (#test failures: 0, #R errors: 1)

In addition: Warning messages:
1: Error detected in cell X106 - Value is not available 
2: Error detected in cell Y104 - Value is not available 
3: Error detected in cell X106 - Value is not available 
4: Error detected in cell Y104 - Value is not available 
Execution halted
